# -*- coding: utf-8 -*-
"""ABAP-F.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1NBmNSNM5_4DQe-6oFaiK8zMQcqCVAMgh
"""

import streamlit as st
import pandas as pd
from datetime import date

# SimulaciÃ³n de tablas BKPF y BSEG
BKPF = pd.DataFrame([
    {"BELNR": "1000001", "BUKRS": "MX01", "GJAHR": 2024, "BLDAT": "2024-03-01", "MONAT": 3, "TCODE": "FB01"},
    {"BELNR": "1000002", "BUKRS": "MX01", "GJAHR": 2024, "BLDAT": "2024-03-05", "MONAT": 3, "TCODE": "F-02"},
])

BSEG = pd.DataFrame([
    {"BELNR": "1000001", "BUKRS": "MX01", "HKONT": "100010", "DMBTR": 5000, "SHKZG": "H"},
    {"BELNR": "1000001", "BUKRS": "MX01", "HKONT": "200020", "DMBTR": 5000, "SHKZG": "S"},
    {"BELNR": "1000002", "BUKRS": "MX01", "HKONT": "300030", "DMBTR": 8000, "SHKZG": "H"},
])

def ejecutar_abap(comando):
    comando = comando.strip().upper()
    if comando.startswith("SELECT"):
        if "FROM BKPF" in comando:
            return BKPF
        elif "FROM BSEG" in comando:
            return BSEG
        else:
            return "Tabla no reconocida"
    elif comando.startswith("LOOP AT"):
        tabla = comando.split(" ")[2].strip(".")
        if tabla == "BKPF":
            return BKPF.to_string(index=False)
        elif tabla == "BSEG":
            return BSEG.to_string(index=False)
        else:
            return "Tabla no reconocida en LOOP AT."
    else:
        return "Comando ABAP no reconocido."

# AplicaciÃ³n en Streamlit
st.title("ðŸ’¼ Simulador SAP FI en Python")
st.sidebar.header("MenÃº Principal")

menu = st.sidebar.radio("Selecciona una opciÃ³n", ["Consultar BKPF", "Consultar BSEG", "Ejecutar Comando ABAP"])

if menu == "Consultar BKPF":
    st.subheader("ðŸ“œ Tabla BKPF (Encabezado de Documentos)")
    st.write(BKPF)

elif menu == "Consultar BSEG":
    st.subheader("ðŸ“Š Tabla BSEG (Posiciones de Documentos)")
    st.write(BSEG)

elif menu == "Ejecutar Comando ABAP":
    st.subheader("ðŸ”§ Ejecutar Comando ABAP")
    comando = st.text_area("Ingresa un comando ABAP", "SELECT * FROM BKPF")
    if st.button("Ejecutar"):
        resultado = ejecutar_abap(comando)
        st.write(resultado)